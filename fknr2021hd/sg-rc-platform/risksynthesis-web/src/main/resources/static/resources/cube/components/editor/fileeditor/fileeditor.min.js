define(["FileUploader","cryptocore","md5","JSONUtil"],function(l,q,P,u){function o(o){function G(c){if(typeof FileReader=="function"&&v(c.name)&&H(c.name,c.size)){if(c.type.indexOf("image/")!=-1){var b=new FileReader;b.onload=function(b){r(c.name)&&(a._unuploadCount(a._unuploadCount()+1),b={index:a._items().length+1,name:c.name,src:b.target.result,isImage:!0,isIE:!1,file:c,status:cube.obj(cube.msg("NOTUPLOAD")),progress:cube.obj("0%")},a._items.push(b),a.autoUpload()&&a.uploadFile(b))};b.readAsDataURL(c)}else b=
s(c.name),r(c.name)&&(a._unuploadCount(a._unuploadCount()+1),b={index:a._items().length+1,name:c.name,css:b,isImage:!1,file:c,status:cube.obj(cube.msg("NOTUPLOAD")),progress:cube.obj("0%")},a._items.push(b),a.autoUpload()&&a.uploadFile(b));a.isGetMd5()&&(w=204800,h=0,b=new FileReader,x(c,b))}}function I(c,b){var d="";if(window.navigator.userAgent.indexOf("MSIE")>-1)c.select(),$("#"+a.id()).find("#_fileSelectionHiddenArea").focus(),d=document.selection.createRange().text;if(a.ieHasFile().indexOf(d)==
-1){a.ieHasFile.push(d);var e=J(d);if(v(d)&&r(e))if(K(d)){var f=a.previewSize()=="big"?160:100,g={width:f,height:f},i=$("<div></div>"),j=$("<div style='margin:0px auto;'>");j.css("filter",m(d,"image"));if(navigator.userAgent.indexOf("MSIE 9.0")>-1){var h=document.createElement("div");(document.body||document.documentElement).appendChild(h);with(h.runtimeStyle)filter=m(d,"image"),zoom=width=height=1,overflow="scroll",position="absolute",right="9999em",top="-9999em",border=0;setTimeout(function(){var c=
{height:h.offsetHeight,width:h.offsetWidth};h.parentNode.removeChild(h);c=y(g,c);j.appendTo(i);j[0].style.filter=m(d,"scale");j.width(c.width).height(c.height);a._unuploadCount(a._unuploadCount()+1);c={path:d,index:a._items().length+1,name:e,view:i.html(),isImage:!0,isIE:!0,fileId:b,status:cube.obj(cube.msg("NOTUPLOAD")),progress:cube.obj("0%")};a._items.push(c);a.autoUpload()&&a.uploadFile(c)},500)}else f=L(d),f=y(g,f),j.appendTo(i),j[0].style.filter=m(d,"scale"),j.width(f.width).height(f.height),
a._unuploadCount(a._unuploadCount()+1),f={path:d,index:a._items().length+1,name:e,view:i.html(),isImage:!0,isIE:!0,fileId:b,status:cube.obj(cube.msg("NOTUPLOAD")),progress:cube.obj("0%")},a._items.push(f),a.autoUpload()&&a.uploadFile(f)}else f=s(e),a._unuploadCount(a._unuploadCount()+1),f={path:d,index:a._items().length+1,name:e,css:f,isImage:!1,fileId:b,status:cube.obj(cube.msg("NOTUPLOAD")),progress:cube.obj("0%")},a._items.push(f),a.autoUpload()&&a.uploadFile(f)}}function x(a,b){var d=Math.min(h+
w,a.size);b.onload=function(e){h=d;b.readAsBinaryString?t.update(q.enc.Latin1.parse(e.target.result)):t.update(M(e.target.result));parseFloat(h);parseFloat(a.size);h<a.size?x(a,b):(e=t.finalize(),a.md5=e.toString())};if(a.slice)var e=a.slice(h,d);else a.webkitSlice?e=a.webkitSlice(h,d):File.prototype.mozSlice&&(e=a.mozSlice(h,d));b.readAsBinaryString?b.readAsBinaryString(e):b.readAsArrayBuffer(e)}function M(a){for(var a=new Uint8Array(a),b=[],d=0;d<a.length;d+=4)b.push(a[d]<<24|a[d+1]<<16|a[d+2]<<
8|a[d+3]);return q.lib.WordArray.create(b,a.length)}function r(c){if(a.maxCount()>0&&a._items().length>=a.maxCount())return a._validitems.push({name:c,msg:cube.msg("UPLOAD_MAXALLOWED",a.maxCount())}),!1;return!0}function H(c,b){b/=1024;if(a.maxFileSize()>0&&b>=a.maxFileSize())return a._validitems.push({name:c,msg:cube.msg("UPLOAD_SIZE_LIMIT",N(a.maxFileSize()*1024))}),!1;return!0}function N(a){var b=null;return b=a<1024?a+"B":a>=1024&&a<1048576?z(a/1024)+"KB":z(a/1048576)+"MB"}function z(a){var b=
parseFloat(a);return b=isNaN(b)?0:Math.round(a*100)/100}function v(c){if(cube.isEmpty(c))return!1;var b=c.split("."),b=b[b.length-1];if((","+a.allowTypes()).indexOf(b)==-1)return a._validitems.push({name:c,msg:cube.msg("FILE_TYPE_LIMITED",b)}),!1;return!0}function K(a){if(cube.isEmpty(a))return!1;a=a.split(".");if(",jpg,jpeg,gif,png,bmp".indexOf(a[a.length-1])==-1)return!1;return!0}function m(a,b){return"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a+"', sizingMethod='"+b+"')"}function L(a){var b=
document.createElement("div");(document.body||document.documentElement).appendChild(b);with(b.runtimeStyle)filter=m(a,"image"),zoom=width=height=1,position="absolute",right="9999em",top="-9999em",border=0;a={height:b.offsetHeight,width:b.offsetWidth};b.parentNode.removeChild(b);return a}function y(c,b){var d={};c.width<b.width||c.height<b.height?(d=c.width/b.width<c.height/b.height?c.width/b.width:c.height/b.height,d={width:b.width*d,height:b.height*d}):d=b;if(d.width==1&&d.height==1){var e=a.previewSize();
d.width=e=="big"?160:90;d.height=e=="big"?160:90}return d}function J(a){a=a.split("\\");a=a[a.length-1];a=a.split("/");return a[a.length-1]}function s(a){var b={"icon-word":"doc,docx","icon-excel":"xls,xlsx","icon-ppt":"ppt,pptx","icon-pdf":"pdf","icon-txt":"txt","icon-rar":"zip,rar,tar,tgz,arj","icon-music":"wav,mp3,ogg","icon-film":"avi,mpg,mpeg,rm,move","icon-picture":"jpg,jpeg,gif,png,bmp"},d="",a=a.split(".");a.length>1&&(d=a[a.length-1].toLowerCase());for(var e in b)if(b[e].indexOf(d)!=-1)return e;
return"icon-file"}function A(c){var b={cancel:!1,item:c,params:a.params(),fileUploaderParams:null};if(a.onItemUploading!=null&&!cube.isObservable(a.onItemUploading)&&(a.onItemUploading(b),b.cancel)){c.status(cube.msg("UPLOADCACEL"));return}c.status(cube.msg("UPLOADING"));var d=new l;d.url=a.url();d.file=c.file;d.paramsByPost=a.paramsByPost();d.params=n(b.params);if(cube.notEmpty(b.fileUploaderParams))d.params=b.fileUploaderParams;d.onprogresschange=function(b){c.progress(b+"%");cube.isNumber(b)&&
a.progress(parseFloat(a.progress())+b/B+"%");c.status()==cube.msg("UPLOADFAIL")&&c.progress("0%")};d.onprogresscomplete=function(){};d.onprogresserror=function(){c.status(cube.msg("UPLOADFAIL"))};d.oncanceled=function(){c.status(cube.msg("UPLOADCACEL"))};d.onuploadcomplete=function(b){var d=b.resultValue,g=c.name,b=b.resultValue,i=null;b.charAt(2)==":"&&(i=b.substring(3,b.length),b=parseInt(b.substring(0,2)));var h=u.getItem(a._validitems(),"name",g);h&&a._validitems.remove(h);if(b==-2||b==-3||b==
-4||b==-5){if(c.status(cube.msg("UPLOADFAIL")),c.progress("0%"),b==-3?a._validitems.push({name:g,msg:cube.msg("FILE_TYPE_LIMITED",[i])}):b==-4?a._validitems.push({name:g,msg:cube.msg("FILE_TYPE_ALLOWED",[i])}):b==-5?a._validitems.push({name:g,msg:cube.msg("UPLOAD_SIZE_LIMIT",[a.maxFileSize()+"KB"])}):i?a._validitems.push({name:g,msg:i}):a._validitems.push({name:g,msg:cube.msg("UPLOADFAIL")}),a.onItemUploadFail!=null&&!cube.isObservable(a.onItemUploadFail))a.onItemUploadFail(c,d)}else if(c.status()!=
cube.msg("UPLOADED")){a._unuploadCount(a._unuploadCount()-1);a._uploadedCount(a._uploadedCount()+1);c.status(cube.msg("UPLOADED"));if(a.onItemUploaded!=null&&!cube.isObservable(a.onItemUploaded)&&(g={cancel:!1},a.onItemUploaded(c,d,g),g.cancel==!0)){a._unuploadCount(a._unuploadCount()+1);a._uploadedCount(a._uploadedCount()-1);c.status(cube.msg("UPLOADFAIL"));c.progress("0%");return}a._onChanged();for(b=g=0;b<a._items().length;b++)a._items()[b].status()!=cube.msg("UPLOADED")&&g++;if(g==0){if(a.onAllItemUploaded!=
null&&!cube.isObservable(a.onAllItemUploaded))a.onAllItemUploaded(a.name(),a._items(),d);a._onChanged()}}};d.upload()}function n(c){var b={},d=a.type();if(a.filePath())b.filePath=a.filePath();if(d=="form"||d=="grid")b.tableName=a.tableName(),b.primaryKey=a.primaryKey(),b.pkVal=a.pkVal(),b.colName=a.colName();b.uploadMode=a.uploadMode();b.isVirtual=a.isVirtual();b.params=cube.notEmpty(c)?c:a.params();return b}function O(c){var b=null,d=a.type(),c=c.replace(/\+/g,"%2B"),e=a.filePath()?a.filePath().replace(/\+/g,
"%2B"):"",f=e?"&filePath="+e:"";if(d=="path")b=encodeURI(encodeURI(a.url()+"?option=download&filePath="+e+"&fileName="+c+"&uploadMode="+a.uploadMode()+"&rnd="+cube.random()));else if(d=="form"||d=="grid")b=encodeURI(encodeURI(a.url()+"?option=download&tableName="+a.tableName()+"&pkVal="+a.pkVal()+"&colName="+a.colName()+"&fileName="+c+"&uploadMode="+a.uploadMode()+f+"&rnd="+cube.random()));return b}function C(c){if(c.status()!=cube.msg("UPLOADED")){var b={cancel:!1,item:c,params:a.params(),fileUploaderParams:null};
if(a.onItemUploading!=null&&!cube.isObservable(a.onItemUploading)){if(a.isGetMd5()&&!c.file)c.file={md5:""};a.onItemUploading(b);if(b.cancel){c.status(cube.msg("UPLOADCACEL"));return}}c.status(cube.msg("UPLOADING"));var d=document.getElementById(a.id()),e=$("#"+a.id()).find("#file_"+c.fileId);e.get(0).disabled=!1;var f=D();E(f);f.send("option=startUpload&rnd="+cube.random());if(f.status==200){if(!f.responseText)throw c.status(cube.msg("UPLOADFAIL")),"error";p=f.responseText.replace(/^\s*/,"").replace(/\s*$/,
"")}else throw c.status(cube.msg("UPLOADFAIL")),"error";F(c);c=cube.notEmpty(b.params)?b.params:a.params();cube.isObject(c)&&(c=JSON.stringify(c));if(cube.notEmpty(b.fileUploaderParams)){var g,c=a.url(),b=b.fileUploaderParams,h=f="";for(g in b)f!=""&&(f+="&"),f+=typeof b[g]=="string"&&b[g].replace(/^\s*/,"").replace(/\s*$/,"")==""?g+"=":g=="fileName"?g+"="+b[g]:g=="params"?g+"="+JSON.stringify(b[g]):g+"="+encodeURIComponent(encodeURIComponent(b[g]));h=c+(cube.isEmpty(f)?"":(cube.isEmpty(c)?"":"?")+
f);g=h+"&rnd="+cube.random();d.action=g}else if(a.type()=="path")d.action=encodeURI(a.url()+"?option=upload&maxFileSize="+a.maxFileSize()+"&sessionId="+p+"&fileName="+a.name()+"&filePath="+a.filePath()+"&uploadMode="+a.uploadMode()+"&params="+c+"&isVirtual="+a.isVirtual()+"&rnd="+cube.random());else if(a.type()=="form"||a.type()=="grid")d.action=encodeURI(a.url()+"?option=upload&maxFileSize="+a.maxFileSize()+"&sessionId="+p+"&tableName="+a.tableName()+"&primaryKey="+a.primaryKey()+"&pkVal="+a.pkVal()+
"&colName="+a.colName()+(a.filePath()?"&filePath="+a.filePath():"")+"&uploadMode="+a.uploadMode()+"&params="+c+"&isVirtual="+a.isVirtual()+"&rnd="+cube.random());d.submit();e.get(0).disabled=!0}}function F(c){var b=D();E(b);b.send("option=getProgress&sessionId="+p+"&rnd="+cube.random());if(b.status==200&&(b=b.responseText.replace("&","&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/script/gi,"").replace(/%/g,"&#37").replace(/\r/g,"").replace(/\n/g,
""))){var d=b.split(":");if(d[0]==-2)throw d.length>1&&d[1]&&a._validitems.push({name:c.name,msg:d[1]}),c.status(cube.msg("UPLOADFAIL")),"error";else if(d[0]==-3)throw c.status(cube.msg("UPLOADFAIL")),a._validitems.push({name:c.name,msg:cube.msg("FILE_TYPE_LIMITED",[d[1]])}),"error";else if(d[0]==-4)throw c.status(cube.msg("UPLOADFAIL")),a._validitems.push({name:c.name,msg:cube.msg("FILE_TYPE_ALLOWED",[d[1]])}),"error";else if(d[0]==-5)throw c.status(cube.msg("UPLOADFAIL")),a._validitems.push({name:c.name,
msg:cube.msg("UPLOAD_SIZE_LIMIT",[a.maxFileSize()+"KB"])}),"error";b=parseInt(b,10);if(isNaN(b))throw c.status(cube.msg("UPLOADFAIL")),"error";if(b!=-1)try{window.setTimeout(function(){F(c)},500)}catch(e){}else if(b==-1){c.status(cube.msg("UPLOADED"));c.progress("100%");a._unuploadCount(a._unuploadCount()-1);a._uploadedCount(a._uploadedCount()+1);if(a.onItemUploaded!=null&&!cube.isObservable(a.onItemUploaded)&&(d={cancel:!1},a.onItemUploaded(c,b,d),d.cancel==!0)){a._unuploadCount(a._unuploadCount()+
1);a._uploadedCount(a._uploadedCount()-1);c.status(cube.msg("UPLOADFAIL"));c.progress("0%");return}a._onChanged();for(d=b=0;d<a._items().length;d++)a._items()[d].status()!=cube.msg("UPLOADED")&&b++;if(b==0){if(a.onAllItemUploaded!=null&&!cube.isObservable(a.onAllItemUploaded))a.onAllItemUploaded(a.name(),a._items());a._onChanged()}}}}function D(){var a=null;window.ActiveXObject?a=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(a=new XMLHttpRequest);return a}function E(c){var b=cube.getIEVersion();
cube.ieCorsProxy&&b>-1&&b<=9&&cube.crosDomain(a.url())?(c.open("POST",cube.mappath(cube.ieCorsProxyHost),!1),c.setRequestHeader("X-CorsProxy-Url",a.url())):c.open("POST",a.url(),!1);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8")}var a=this;a.id="";a.name="";a.url="";a.removeUrl="";a.readOnly=!1;a.isShowPreview=!0;a.previewSize="big";a.previewModel=!1;a.autoUpload=!1;a.isShowUploadButton=!0;a.isShowRemoveButton=!0;a.isShowDownloadButton=!0;a.isShowThumbnail=!0;
a.isShowControl=!0;a.maxCount=0;a.maxFileSize=0;a.allowTypes="jpg,jpeg,gif,png,bmp,tiff,txt";a.type="path";a.filePath=null;a.tableName="";a.primaryKey="";a.pkVal="";a.colName="";a.uploadMode="file";a.params="";a.paramsByPost=!1;a.isVirtual=!1;a.autoLoadFiles=!0;a.isGetMd5=!1;a.isIE=!1;a.onItemRemoving=null;a.onItemRemoved=null;a.onAllItemRemoving=null;a.onAllItemRemoved=null;a.onItemUploading=null;a.onItemUploaded=null;a.onItemUploadFail=null;a.onAllItemUploaded=null;a.onDownloading=null;a.onRendered=
null;a.onChanged=null;a._items=[];a._validitems=[];a._files=[];a._showErrorMessage=!1;a._uploadedCount=0;a._unuploadCount=0;a._fileAccept="";a.ieHasFile=[];a.animatShowDialog=!1;a.progress="0%";var B=0;a._init=function(){typeof FileReader=="function"?a.isIE(!1):a.isIE(!0);a._fileAccept("."+a.allowTypes().replace(/\,/g,",."));cube.isEmpty(a.id())&&a.id("fileForm_"+cube.random().toString().split("&")[0]);a._validitemsSub=cube.subscribe(a._validitems,function(){a._validitems().length>0?a._showErrorMessage(!0):
a._showErrorMessage(!1)});if(cube.notEmpty(a.url())){var c=new l;c.url=a.url();c.params=n();var b=[];a.autoLoadFiles()&&(b=c.getUploadedFiles());for(c=0;c<b.length;c++){var d=s(b[c].attName);a._items.push({index:c+1,name:b[c].attName,css:d,isImage:d=="icon-picture"?!0:!1,isIE:!1,src:d=="icon-picture"?O(b[c].attName):"",status:cube.obj(cube.msg("UPLOADED")),progress:cube.obj("100%")})}a._onChanged()}};var k=1;a.fileChange=function(c,b){a._validitems.removeAll();if(typeof FileReader=="function"){var d=
b.target.files;if(d&&d.length>0)for(var e=0;e<d.length;e++)G(d[e]);d=$(b.target);e=d.clone().val("");d.after(e);d.remove();e.attr("data-bind","event: {change: fileChange}, attr:{disabled: readOnly, accept: _fileAccept}");cube.bindTemlate(e,{fileChange:a.fileChange,readOnly:a.readOnly,_fileAccept:a._fileAccept})}else I(b.target,k),b.target.disabled=!0,b.target.style.display="none",k=cube.random().toString().split("&")[0],d="file_"+k,a._files.push("<input name='file' id='"+d+"' type='file'>"),d=$("#"+
d),d.attr("data-bind","event: {change: fileChange}, attr:{disabled: readOnly, accept: _fileAccept}"),cube.bindTemlate(d,{fileChange:a.fileChange,readOnly:a.readOnly,_fileAccept:a._fileAccept})};a.removeFile=function(){var c=this;cube.indicate("confirm",cube.msg("CONFIRM_DELETE"),function(){var b=!0;if(a.onItemRemoving!=null&&!cube.isObservable(a.onItemRemoving)){var d={cancel:!1,item:c};a.onItemRemoving(d);if(d.cancel)return}(d=u.getItem(a._validitems(),"name",c.name))&&a._validitems.remove(d);var e=
c.index;if(c.status()==cube.msg("UPLOADED")||c.status()==cube.msg("DELETEFAIL")){var d=new l,f=a.url(),g=a.removeUrl();cube.notEmpty(g)&&(f=g);d.url=f;d.params=n();if(d=d.removeFile(c.name)){a._items.remove(c);cube.notEmpty(c.path)&&a.ieHasFile.remove(c.path);a._uploadedCount(a._uploadedCount()-1);if(a.onItemRemoved!=null&&!cube.isObservable(a.onItemRemoved))a.onItemRemoved(c,d);a._onChanged()}else c.status(cube.msg("DELETEFAIL")),b=!1}else if(a._items.remove(c),cube.notEmpty(c.path)&&a.ieHasFile.remove(c.path),
a._unuploadCount(a._unuploadCount()-1),a.onItemRemoved!=null&&!cube.isObservable(a.onItemRemoved))a.onItemRemoved(c);if(b&&(b=$("#"+a.id()).find("input"))){var h=1;b.each(function(){a.isIE()?h==e&&($(c).remove(),a._items.remove(h)):$(c).val("");h++});if((b=$("#"+a.id()).find("input"))&&b.length==0)k=cube.random().toString().split("&")[0],b="file_"+k,a._files.push("<input name='file' id='"+b+"' type='file'>"),b=$("#"+b),b.attr("data-bind","event: {change: fileChange}, attr:{disabled: readOnly, accept: _fileAccept}"),
cube.bindTemlate(b,{fileChange:a.fileChange,readOnly:a.readOnly,_fileAccept:a._fileAccept})}})};a.clearFiles=function(c){a._items().length>0&&cube.indicate("confirm",cube.msg("CONFIRM_DELETEALL"),function(){a._clearFiles(c)})};a.clearFilesWithoutConfirm=function(c){a._items().length>0&&a._clearFiles(c)};a._clearFiles=function(c){if(a.onAllItemRemoving!=null&&!cube.isObservable(a.onAllItemRemoving)){var b={cancel:!1,items:a._items()};a.onAllItemRemoving(b);if(b.cancel)return}a._validitems.removeAll();
if(c!=!1)for(c=a._items().length-1;c>=0;c--){b=!0;if(a._items()[c].status()==cube.msg("UPLOADED")||a._items()[c].status()==cube.msg("DELETEFAIL")){var d=new l,e=a.url(),f=a.removeUrl();cube.notEmpty(f)&&(e=f);d.url=e;d.params=n();d.removeFile(a._items()[c].name)?(cube.notEmpty(a._items()[c].path)&&a.ieHasFile.remove(a._items()[c].path),a._items.remove(a._items()[c]),a._uploadedCount(a._uploadedCount()-1)):(a._items()[c].status(cube.msg("DELETEFAIL")),b=!1)}else cube.notEmpty(a._items()[c].path)&&
a.ieHasFile.remove(a._items()[c].path),a._items.remove(a._items()[c]),a._unuploadCount(a._unuploadCount()-1);if(b&&(b=$("#"+a.id()).find("input"))&&b.eq(c))if(a.isIE()?b.eq(c).remove():b.eq(c).val(""),(b=$("#"+a.id()).find("input"))&&b.length==0)k=cube.random().toString().split("&")[0],b="file_"+k,a._files.push("<input name='file' id='"+b+"' type='file'>"),b=$("#"+b),b.attr("data-bind","event: {change: fileChange}, attr:{disabled: readOnly, accept: _fileAccept}"),cube.bindTemlate(b,{fileChange:a.fileChange,
readOnly:a.readOnly,_fileAccept:a._fileAccept})}if(a._items().length==0){a._unuploadCount(0);a._uploadedCount(0);if(a.onAllItemRemoved!=null&&!cube.isObservable(a.onAllItemRemoved))a.onAllItemRemoved();a._onChanged()}};a.uploadFile=function(c){a.isIE()?C(c):A(c)};a.uploadFiles=function(){a._validitems.removeAll();B=a._unuploadCount();a.isShowControl()||a.closeDialog();for(var c=0;c<a._items().length;c++)a._items()[c].status()!=cube.msg("UPLOADED")&&(a.isIE()?C(a._items()[c]):A(a._items()[c]))};a.downloadFile=
function(){if(!(a.onDownloading!=null&&!cube.isObservable(a.onDownloading)&&a.onDownloading(this)==!1)){var c=new l;c.url=a.url();c.params=n();c.onprogresschange=function(a){item.progress(a+"%")};c.onprogresscomplete=function(){item.status(cube.msg("DOWNLOADED"))};c.onprogresserror=function(){item.status(cube.msg("DOWNLOADFAIL"))};c.oncanceled=function(){item.status(cube.msg("DOWNLOADCANCEL"))};c.download(this.name)}};a.hidePreview=function(){a.isShowPreview(!1)};var w=204800,h=0;a._onChanged=function(){if(a.onChanged!=
null&&!cube.isObservable(a.onChanged)){for(var c="",b=a._items(),d=0;d<b.length;d++)c+=b[d].name+";";c!=""&&(c=c.substring(0,c.length-1));a.onChanged(a.name(),c)}};a.showDialog=function(){a.animatShowDialog(!0)};a.closeDialog=function(){a.animatShowDialog(!1)};var t=q.algo.MD5.create(),p="";a.onload=function(c){if(a.onRendered!=null&&!cube.isObservable(a.onRendered))a.onRendered(c)};cube.endViewModel(a,o)}o.prototype.dispose=function(){this._validitemsSub.dispose()};return o});