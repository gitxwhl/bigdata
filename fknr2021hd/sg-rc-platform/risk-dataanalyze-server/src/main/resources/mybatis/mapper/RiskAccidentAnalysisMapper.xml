<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.raysdata.riskdataanalyzeserver.mapper.RiskAccidentAnalysisMapper">


    <!--/*
     *设备事故表查询
     * paramJson:{"page":"", "size":"", "params":{"accidentGrade":"","voltageCapacity":"","gridcorp":"","deviceClass":"","startTime":"","endTime":""}}
     * */-->
    <select id="getDataFromDictionaries" parameterType="java.lang.String" resultType="map">
        select column_type_code from srp_risk_sys_tab
        where
        column_code = 'VOLTAGE_LEVEL'
        and  column_type_name like concat("%",#{voltageCapacity},"%")
    </select>
    <select id="getDataFromDictionarie" parameterType="java.lang.String"
            resultType="java.lang.String">
        select column_type_code
        from srp_risk_sys_tab
        where
        column_code = 'DATAREPORT_ORG'
        and column_type_name like concat("%",#{gridcorp},"%")
    </select>
    <select id="getEquipAccidentListCNT" parameterType="map" resultType="int">
        select count(1) cnt from bd_inc_equipaccident
        where 1=1

        <if test="accidentGrade !=null and accidentGrade !=''">
            and ACCIDENTGRADE =#{accidentGrade}
        </if>
        <if test="columnTypeCodes !=null and columnTypeCodes.size >0">
            and VOLTAGE_CAPACITY in
            <foreach collection="columnTypeCodes" item="columnTypeCode" separator="," open="("
                     close=")">
                #{columnTypeCode}
            </foreach>
        </if>
<!--        <if test="voltageCapacity !=null and voltageCapacity !=''">-->
<!--            and VOLTAGE_CAPACITY =#{voltageCapacity}-->
<!--        </if>-->

        <if test="dataFromDictionaries !=null and dataFromDictionaries !=''">
            and GRIDCORP =#{dataFromDictionaries}
        </if>

        <if test="deviceClass !=null and deviceClass !=''">
            and DEVICECLASS =#{deviceClass}
        </if>
        <if test="startTime !=null and startTime!=''">
            and BGNTIME >= STR_TO_DATE(#{startTime},'%Y-%m-%d %H:%i:%s')
        </if>
        <if test="endTime !=null and endTime!=''">
            and STR_TO_DATE(#{endTime},'%Y-%m-%d %H:%i:%s') >=BGNTIME
        </if>
    </select>
    <select id="getEquipAccidentList" parameterType="map" resultType="map">
        SELECT
        d.column_type_name ACCIDENTGRADE,
        a.TITLE,
        h.column_type_name VOLTAGE_CAPACITY,
        i.column_type_name GRIDCORP,
        g.column_type_name REASON,
        f.column_type_name DUTY,
        c.column_type_name DEVICECLASS,
        a.ACCIDENTCORP,
        a.BGNTIME,
        a.STARTTIME,
        a.ENDTIME
        FROM
        ( SELECT * FROM bd_inc_equipaccident
        WHERE 1 = 1
        <if test="accidentGrade !=null and accidentGrade !=''">
            and ACCIDENTGRADE =#{accidentGrade}
        </if>
        <if test="columnTypeCodes !=null and columnTypeCodes.size >0">
            and VOLTAGE_CAPACITY in
            <foreach collection="columnTypeCodes" item="columnTypeCode" separator="," open="("
                     close=")">
                #{columnTypeCode}
            </foreach>
        </if>
        <if test="dataFromDictionaries !=null and dataFromDictionaries !=''">
            and GRIDCORP =#{dataFromDictionaries}
        </if>
        <if test="deviceClass !=null and deviceClass !=''">
            and DEVICECLASS =#{deviceClass}
        </if>
        <if test="startTime !=null and startTime!=''">
            and BGNTIME >= STR_TO_DATE(#{startTime},'%Y-%m-%d %H:%i:%s')
        </if>
        <if test="endTime !=null and endTime!=''">
            and STR_TO_DATE(#{endTime},'%Y-%m-%d %H:%i:%s') >=BGNTIME
        </if>
        limit #{offset},#{limit}
        ) a
        LEFT JOIN ( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'YBCLASS' ) b ON a.YBCLASS =
        b.column_type_code
        LEFT JOIN ( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'DEVICECLASS' ) c ON
        a.DEVICECLASS = c.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'ACCIDENTGRADE' ) d ON
        a.ACCIDENTGRADE = d.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'ACCIDENTCLASS' ) e ON
        a.ACCIDENTCLASS = e.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'DUTY' ) f ON a.DUTY =
        f.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'VOLTAGE_LEVEL' ) h ON
        a.VOLTAGE_CAPACITY = h.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'DATAREPORT_ORG' ) i ON
        a.GRIDCORP = i.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'REASON') g ON a.REASON =
        g.column_type_code
    </select>

    <!--/*
     *人身事故表查询
     * paramJson:{"page":"", "size":"", "params":{"accidentGrade":"","accidentClass":"","injuryDegree":"","startTime":"","endTime":""}}
     * */-->
    <select id="getPersonalAccidentListCNT" parameterType="map" resultType="int">
        select count(1) cnt from bd_inc_personalaccident
        where 1=1
        <if test="accidentGrade !=null and accidentGrade != ''">
            and ACCIDENTGRADE =#{accidentGrade}
        </if>
        <if test="accidentClass !=null and accidentClass != ''">
            and ACCIDENTCLASS =#{accidentClass}
        </if>
        <if test="injuryDegree !=null and injuryDegree != ''">
            and INJURY_DEGREE =#{injuryDegree}
        </if>
        <if test="startTime !=null and startTime!=''">
            and BGNTIME >= STR_TO_DATE(#{startTime},'%Y-%m-%d %H:%i:%s')
        </if>
        <if test="endTime !=null and endTime!=''">
            and STR_TO_DATE(#{endTime},'%Y-%m-%d %H:%i:%s') >=BGNTIME
        </if>
    </select>
    <select id="getPersonalAccidentList" parameterType="map" resultType="map">
        SELECT
        d.column_type_name ACCIDENTGRADE,
        a.TITLE,
        e.column_type_name ACCIDENTCLASS,
        a.VICTIM,
        b.column_type_name INJURY_DEGREE,
        a.ACCIDENTCORP,
        a.BGNTIME,
        a.STARTTIME,
        a.ENDTIME
        FROM
        ( SELECT * FROM bd_inc_personalaccident
        WHERE 1 = 1
        <if test="accidentGrade !=null and accidentGrade != ''">
            and ACCIDENTGRADE =#{accidentGrade}
        </if>
        <if test="accidentClass !=null and accidentClass != ''">
            and ACCIDENTCLASS =#{accidentClass}
        </if>
        <if test="injuryDegree !=null and injuryDegree != ''">
            and INJURY_DEGREE =#{injuryDegree}
        </if>
        <if test="startTime !=null and startTime!=''">
            and BGNTIME >= STR_TO_DATE(#{startTime},'%Y-%m-%d %H:%i:%s')
        </if>
        <if test="endTime !=null and endTime!=''">
            and STR_TO_DATE(#{endTime},'%Y-%m-%d %H:%i:%s') >=BGNTIME
        </if>
        limit #{offset},#{limit}
        ) a
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'ACCIDENTGRADE' ) d ON
        a.ACCIDENTGRADE = d.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'ACCIDENTCLASS' ) e ON
        a.ACCIDENTCLASS = e.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'INJURY_DEGREE' ) b ON
        a.INJURY_DEGREE = b.column_type_code
    </select>

    <!--/*
     *电网事故表查询
     * paramJson:{"page":"", "size":"", "params":{"accidentGrade":"","voltageCapacity":"","deviceClass":"","startTime":"","endTime":""}}
     * */-->
    <select id="getDataFromDictionaries2" parameterType="java.lang.String"
            resultType="java.lang.String">
        select column_type_code from srp_risk_sys_tab
        where column_code = 'VOLTAGE_LEVEL' and column_type_name like concat("%",#{voltageCapacity},"%")
    </select>
    <select id="getPowerGridAccidentListCNT" parameterType="java.lang.String" resultType="int">
        select count(1) cnt from bd_inc_powergridaccident
        where 1=1
        <if test="accidentGrade !=null and accidentGrade != ''">
            and ACCIDENTGRADE =#{accidentGrade}
        </if>

        <if test="dataFromDictionaries !=null and dataFromDictionaries.size > 0">
            and VOLTAGE_CAPACITY IN
          <foreach collection="dataFromDictionaries" item="dataFromDictionarie" open="(" close=")" separator=",">
              #{dataFromDictionarie}
          </foreach>
        </if>

        <if test="deviceClass !=null and deviceClass != ''">
            and DEVICECLASS =#{deviceClass}
        </if>
        <if test="startTime !=null and startTime!=''">
            and BGNTIME >= STR_TO_DATE(#{startTime},'%Y-%m-%d %H:%i:%s')
        </if>
        <if test="endTime !=null and endTime!=''">
            and STR_TO_DATE(#{endTime},'%Y-%m-%d %H:%i:%s') >=BGNTIME
        </if>

    </select>
    <select id="getPowerGridAccidentList" parameterType="java.lang.String" resultType="map">
        SELECT
        d.column_type_name ACCIDENTGRADE,
        a.TITLE,
        f.column_type_name VOLTAGE_CAPACITY,
        e.column_type_name REASON,
        b.column_type_name DUTY,
        c.column_type_name DEVICECLASS,
        a.ACCIDENTCORP,
        a.BGNTIME,
        a.STARTTIME,
        a.ENDTIME
        FROM
        ( SELECT * FROM bd_inc_powergridaccident
        WHERE 1 = 1
        <if test="accidentGrade !=null and accidentGrade != ''">
            and ACCIDENTGRADE =#{accidentGrade}
        </if>
        <if test="dataFromDictionaries !=null and dataFromDictionaries != '' and dataFromDictionaries.size > 0">
            and VOLTAGE_CAPACITY IN
            <foreach collection="dataFromDictionaries" item="dataFromDictionarie" open="(" close=")" separator=",">
                #{dataFromDictionarie}
            </foreach>
        </if>
        <if test="deviceClass !=null and deviceClass != ''">
            and DEVICECLASS =#{deviceClass}
        </if>
        <if test="startTime !=null and startTime!=''">
            and BGNTIME >= STR_TO_DATE(#{startTime},'%Y-%m-%d %H:%i:%s')
        </if>
        <if test="endTime !=null and endTime!=''">
            and STR_TO_DATE(#{endTime},'%Y-%m-%d %H:%i:%s') >=BGNTIME
        </if>
        limit #{offset},#{limit}
        ) a
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'ACCIDENTGRADE' ) d ON
        a.ACCIDENTGRADE = d.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'REASON' ) e ON a.REASON =
        e.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'DUTY' ) b ON a.DUTY =
        b.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'VOLTAGE_LEVEL' ) f ON
        a.VOLTAGE_CAPACITY = f.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'DEVICECLASS' ) c ON
        a.DEVICECLASS = c.column_type_code
    </select>
    <!--/*
     *网络信息事故表查询
     * paramJson:{"page":"", "size":"", "params":{"accidentGrade":"","accidentClass":"","deviceClass":"","startTime":"","endTime":""}}
     * */-->
    <select id="getInformAccidentListCNT" parameterType="java.lang.String" resultType="int">
        select count(1) cnt from bd_inc_informaccident
        where 1=1
        <if test="accidentGrade != null and accidentGrade != ''">
            and ACCIDENTGRADE =#{accidentGrade}
        </if>
        <if test="accidentClass != null and accidentClass != ''">
            and ACCIDENTCLASS =#{accidentClass}
        </if>
        <if test="deviceClass != null and deviceClass != ''">
            and DEVICECLASS =#{deviceClass}
        </if>
        <if test="startTime !=null and startTime!=''">
            and BGNTIME >= STR_TO_DATE(#{startTime},'%Y-%m-%d %H:%i:%s')
        </if>
        <if test="endTime !=null and endTime!=''">
            and STR_TO_DATE(#{endTime},'%Y-%m-%d %H:%i:%s') >=BGNTIME
        </if>
    </select>
    <select id="getInformAccidentList" parameterType="java.lang.String" resultType="map">
        SELECT
        d.column_type_name ACCIDENTGRADE,
        a.TITLE,
        e.column_type_name ACCIDENTCLASS,
        c.column_type_name DEVICECLASS,
        a.ACCIDENTCORP,
        a.BGNTIME,
        a.STARTTIME,
        a.ENDTIME
        FROM
        ( SELECT * FROM bd_inc_informaccident
        WHERE 1 = 1
        <if test="accidentGrade != null and accidentGrade != ''">
            and ACCIDENTGRADE =#{accidentGrade}
        </if>
        <if test="accidentClass != null and accidentClass != ''">
            and ACCIDENTCLASS =#{accidentClass}
        </if>
        <if test="deviceClass != null and deviceClass != ''">
            and DEVICECLASS =#{deviceClass}
        </if>
        <if test="startTime !=null and startTime!=''">
            and BGNTIME >= STR_TO_DATE(#{startTime},'%Y-%m-%d %H:%i:%s')
        </if>
        <if test="endTime !=null and endTime!=''">
            and STR_TO_DATE(#{endTime},'%Y-%m-%d %H:%i:%s') >=BGNTIME
        </if>
        limit #{offset},#{limit}
        ) a
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'ACCIDENTGRADE' ) d ON
        a.ACCIDENTGRADE = d.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'INFORMACCIDENTCLASS' ) e ON
        a.ACCIDENTCLASS = e.column_type_code
        LEFT JOIN( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'INFORMDEVICECLASS' ) c ON
        a.DEVICECLASS = c.column_type_code
    </select>

    <!--/*
     *安全事故分类统计
     * paramJson:{"timeType":""}
     * */-->
    <select id="getEquipAccidentListCNT1" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_equipaccident
        where 1=1  and TO_DAYS(BGNTIME) = TO_DAYS(curdate())

    </select>
    <select id="getEquipAccidentListCNT2" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_equipaccident
        where 1=1  and YEARWEEK(DATE_FORMAT(BGNTIME,'%Y-%m-%d'),1) = YEARWEEK(now(),1)

    </select>
    <select id="getEquipAccidentListCNT3" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_equipaccident
        where 1=1  and date_format(BGNTIME,'%Y-%m') = date_format(curdate(),'%Y-%m')

    </select>
    <select id="getEquipAccidentListCNT4" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_equipaccident
        where 1=1  and year(BGNTIME) = year(now())

    </select>




    <select id="getAllEquipAccidentListCNT4" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_equipaccident
    </select>







    <select id="getPersonalAccidentListCNT1" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_personalaccident
        where 1=1
          and TO_DAYS(BGNTIME) = TO_DAYS(curdate())
    </select>
    <select id="getPowerGridAccidentListCNT1" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_powergridaccident
        where 1=1
          and TO_DAYS(BGNTIME) = TO_DAYS(curdate())
    </select>
    <select id="getInformAccidentListCNT1" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_informaccident
        where 1=1
          and TO_DAYS(BGNTIME) = TO_DAYS(curdate())
    </select>













    <select id="getPersonalAccidentListCNT2" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_personalaccident
        where 1=1
          and YEARWEEK(DATE_FORMAT(BGNTIME,'%Y-%m-%d'),1) = YEARWEEK(now(),1)
    </select>
    <select id="getPowerGridAccidentListCNT2" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_powergridaccident
        where 1=1
          and YEARWEEK(DATE_FORMAT(BGNTIME,'%Y-%m-%d'),1) = YEARWEEK(now(),1)
    </select>
    <select id="getInformAccidentListCNT2" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_informaccident
        where 1=1
          and YEARWEEK(DATE_FORMAT(BGNTIME,'%Y-%m-%d'),1) = YEARWEEK(now(),1)
    </select>





    <select id="getPersonalAccidentListCNT3" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_personalaccident
        where 1=1
          and date_format(BGNTIME,'%Y-%m') = date_format(curdate(),'%Y-%m')
    </select>
    <select id="getPowerGridAccidentListCNT3" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_powergridaccident
        where 1=1
          and date_format(BGNTIME,'%Y-%m') = date_format(curdate(),'%Y-%m')
    </select>
    <select id="getInformAccidentListCNT3" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_informaccident
        where 1=1
          and date_format(BGNTIME,'%Y-%m') = date_format(curdate(),'%Y-%m')
    </select>






    <select id="getPersonalAccidentListCNT4" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_personalaccident
        where 1=1
                  and year(BGNTIME) = year(now())
    </select>

    <select id="getAllPersonalAccidentListCNT4" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_personalaccident
    </select>


    <select id="getPowerGridAccidentListCNT4" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_powergridaccident
        where 1=1
                  and year(BGNTIME) = year(now())
    </select>


    <select id="getAllPowerGridAccidentListCNT4" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_powergridaccident
    </select>

    <select id="getInformAccidentListCNT4" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_informaccident
        where 1=1
                  and year(BGNTIME) = year(now())
    </select>


    <select id="getAllInformAccidentListCNT4" resultType="java.lang.Integer">
        select count(1) cnt from bd_inc_informaccident
    </select>






    <!--/*
     *按类型同比统计,按类型环比统计
     * paramJson:{"type":""}
     * */-->
    <select id="getMap" parameterType="java.lang.String" resultType="map">
        select 
           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y"),'-01') then 1 else NULL end ) as month1,
           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y"),'-02') then 1 else NULL end ) as month2,
           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y"),'-03')then 1 else NULL end ) as month3,
           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y"),'-04') then 1 else NULL end ) as month4,
           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y"),'-05') then 1 else NULL end ) as month5,
           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y"),'-11') then 1 else NULL end ) as month11,
           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y"),'-06') then 1 else NULL end ) as month6,
           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y"),'-07' )then 1 else NULL end ) as month7,
           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y"),'-08' )then 1 else NULL end ) as month8,
           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y"),'-09' )then 1 else NULL end ) as month9,
           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y"),'-10') then 1 else NULL end ) as month10,
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y"),'-12') then 1 else NULL end ) as month12
        from <include refid="sql_where1"/>
    </select>

    <sql id="sql_where1">
       <if test="type==0">
           bd_inc_equipaccident
       </if>
        <if test="type==1">
            bd_inc_personalaccident
        </if>
        <if test="type==2">
            bd_inc_powergridaccident
        </if>
        <if test="type==3">
            bd_inc_informaccident
        </if>
    </sql>


<!--    <select id="getMap2" parameterType="java.lang.String" resultType="map">-->
<!--        select-->
<!--           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-01') then 1 else NULL end ) as month1,-->
<!--           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-02') then 1 else NULL end ) as month2,-->
<!--           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-03')then 1 else NULL end ) as month3,-->
<!--           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-04') then 1 else NULL end ) as month4,-->
<!--           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-05') then 1 else NULL end ) as month5,-->
<!--           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-06') then 1 else NULL end ) as month6,-->
<!--           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-07' )then 1 else NULL end ) as month7,-->
<!--           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-08' )then 1 else NULL end ) as month8,-->
<!--           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-09' )then 1 else NULL end ) as month9,-->
<!--           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-10') then 1 else NULL end ) as month10,-->
<!--           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-11') then 1 else NULL end ) as month11,-->
<!--           count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-12') then 1 else NULL end ) as month12-->
<!--           from ${param}-->
<!--    </select>-->

    <select id="getMap2" parameterType="java.lang.String" resultType="map">
        select
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-01') then 1 else NULL end ) as month1,
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-02') then 1 else NULL end ) as month2,
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-03')then 1 else NULL end ) as month3,
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-04') then 1 else NULL end ) as month4,
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-05') then 1 else NULL end ) as month5,
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-06') then 1 else NULL end ) as month6,
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-07' )then 1 else NULL end ) as month7,
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-08' )then 1 else NULL end ) as month8,
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-09' )then 1 else NULL end ) as month9,
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-10') then 1 else NULL end ) as month10,
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-11') then 1 else NULL end ) as month11,
            count(case when date_format(BGNTIME,'%Y-%m') = concat(DATE_FORMAT(NOW(),"%Y")-1,'-12') then 1 else NULL end ) as month12
        from <include refid="sql_where1"/>
    </select>


    <select id="getTendencyAnalyzeMap1" resultType="java.util.Map">
        SELECT
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 30 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day30,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 29 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day29,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 28 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day28,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 27 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day27,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 26 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day26,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 25 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day25,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 24 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day24,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 23 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day23,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 22 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day22,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 21 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day21,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 20 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day20,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 19 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day19,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 18 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day18,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 17 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day17,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 16 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day16,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 15 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day15,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 14 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day14,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 13 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day13,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 12 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day12,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 11 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day11,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 10 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day10,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 9 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day9,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 8 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day8,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 7 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day7,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 6 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day6,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 5 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day5,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 4 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day4,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 3 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day3,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 2 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day2,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 1 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day1,
        count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 0 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day0
        FROM bd_inc_personalaccident
    </select>
    <select id="getTendencyAnalyzeMaps1" resultType="java.util.Map">
        select
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -1 day),'%Y-%m-%d') then 1 else NULL end ) as day1,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -2 day),'%Y-%m-%d') then 1 else NULL end ) as day2,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -3 day),'%Y-%m-%d') then 1 else NULL end ) as day3,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -4 day),'%Y-%m-%d') then 1 else NULL end ) as day4,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -5 day),'%Y-%m-%d') then 1 else NULL end ) as day5
        FROM bd_inc_personalaccident
    </select>
    <select id="getTendencyAnalyzeMap2" resultType="java.util.Map">
    SELECT
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 30 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day30,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 29 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day29,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 28 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day28,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 27 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day27,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 26 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day26,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 25 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day25,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 24 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day24,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 23 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day23,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 22 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day22,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 21 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day21,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 20 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day20,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 19 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day19,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 18 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day18,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 17 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day17,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 16 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day16,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 15 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day15,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 14 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day14,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 13 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day13,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 12 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day12,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 11 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day11,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 10 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day10,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 9 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day9,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 8 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day8,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 7 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day7,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 6 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day6,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 5 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day5,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 4 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day4,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 3 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day3,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 2 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day2,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 1 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day1,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 0 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day0
    FROM bd_inc_equipaccident
</select>
    <select id="getTendencyAnalyzeMaps2" resultType="java.util.Map">
        select
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -1 day),'%Y-%m-%d') then 1 else NULL end ) as day1,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -2 day),'%Y-%m-%d') then 1 else NULL end ) as day2,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -3 day),'%Y-%m-%d') then 1 else NULL end ) as day3,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -4 day),'%Y-%m-%d') then 1 else NULL end ) as day4,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -5 day),'%Y-%m-%d') then 1 else NULL end ) as day5
        FROM bd_inc_equipaccident
    </select>
    <select id="getTendencyAnalyzeMap3" resultType="java.util.Map">
    SELECT
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 30 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day30,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 29 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day29,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 28 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day28,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 27 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day27,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 26 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day26,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 25 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day25,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 24 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day24,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 23 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day23,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 22 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day22,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 21 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day21,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 20 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day20,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 19 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day19,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 18 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day18,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 17 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day17,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 16 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day16,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 15 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day15,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 14 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day14,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 13 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day13,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 12 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day12,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 11 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day11,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 10 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day10,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 9 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day9,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 8 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day8,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 7 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day7,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 6 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day6,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 5 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day5,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 4 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day4,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 3 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day3,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 2 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day2,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 1 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day1,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 0 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day0
    FROM bd_inc_powergridaccident
</select>
    <select id="getTendencyAnalyzeMaps3" resultType="java.util.Map">
        select
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -1 day),'%Y-%m-%d') then 1 else NULL end ) as day1,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -2 day),'%Y-%m-%d') then 1 else NULL end ) as day2,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -3 day),'%Y-%m-%d') then 1 else NULL end ) as day3,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -4 day),'%Y-%m-%d') then 1 else NULL end ) as day4,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -5 day),'%Y-%m-%d') then 1 else NULL end ) as day5
        FROM bd_inc_powergridaccident
    </select>
    <select id="getTendencyAnalyzeMap4" resultType="java.util.Map">
    SELECT
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 30 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day30,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 29 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day29,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 28 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day28,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 27 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day27,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 26 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day26,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 25 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day25,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 24 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day24,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 23 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day23,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 22 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day22,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 21 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day21,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 20 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day20,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 19 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day19,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 18 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day18,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 17 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day17,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 16 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day16,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 15 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day15,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 14 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day14,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 13 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day13,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 12 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day12,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 11 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day11,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 10 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day10,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 9 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day9,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 8 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day8,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 7 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day7,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 6 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day6,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 5 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day5,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 4 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day4,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 3 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day3,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 2 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day2,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 1 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day1,
    count( CASE WHEN date_format( BGNTIME, '%Y-%m-%d' ) = DATE_FORMAT( date_sub( now(), INTERVAL 0 DAY ), '%Y-%m-%d' ) THEN 1 ELSE NULL END ) AS day0
    FROM bd_inc_informaccident
</select>
    <select id="getTendencyAnalyzeMaps4" resultType="java.util.Map">
        select
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -1 day),'%Y-%m-%d') then 1 else NULL end ) as day1,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -2 day),'%Y-%m-%d') then 1 else NULL end ) as day2,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -3 day),'%Y-%m-%d') then 1 else NULL end ) as day3,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -4 day),'%Y-%m-%d') then 1 else NULL end ) as day4,
        count(case when date_format(BGNTIME,'%Y-%m-%d') = DATE_FORMAT(date_sub(now(),INTERVAL -5 day),'%Y-%m-%d') then 1 else NULL end ) as day5
        FROM bd_inc_informaccident
    </select>
    <select id="getEquipAccidentGrade" resultType="java.util.Map">
        SELECT
        count( CASE WHEN ACCIDENTGRADE IN ( '01', '02', '03', '04' ) THEN 1 ELSE NULL END ) LEVEL4,
        count( CASE WHEN ACCIDENTGRADE IN ( '05' ) THEN 1 ELSE NULL END ) LEVEL5,
        count( CASE WHEN ACCIDENTGRADE IN ( '06' ) THEN 1 ELSE NULL END ) LEVEL6,
        count( CASE WHEN ACCIDENTGRADE IN ( '07' ) THEN 1 ELSE NULL END ) LEVEL7,
        count( CASE WHEN ACCIDENTGRADE IN ( '08' ) THEN 1 ELSE NULL END ) LEVEL8
        FROM
        bd_inc_equipaccident
    </select>
    <select id="getInformAccidentGrade" resultType="java.util.Map">
        SELECT
        count( CASE WHEN ACCIDENTGRADE IN ( '01', '02', '03', '04' ) THEN 1 ELSE NULL END ) LEVEL4,
        count( CASE WHEN ACCIDENTGRADE IN ( '05' ) THEN 1 ELSE NULL END ) LEVEL5,
        count( CASE WHEN ACCIDENTGRADE IN ( '06' ) THEN 1 ELSE NULL END ) LEVEL6,
        count( CASE WHEN ACCIDENTGRADE IN ( '07' ) THEN 1 ELSE NULL END ) LEVEL7,
        count( CASE WHEN ACCIDENTGRADE IN ( '08' ) THEN 1 ELSE NULL END ) LEVEL8
        FROM
        bd_inc_informaccident

    </select>
    <select id="getPersonalAccidentGrade" resultType="java.util.Map">
        SELECT
        count( CASE WHEN ACCIDENTGRADE IN ( '01', '02', '03', '04' ) THEN 1 ELSE NULL END ) LEVEL4,
        count( CASE WHEN ACCIDENTGRADE IN ( '05' ) THEN 1 ELSE NULL END ) LEVEL5,
        count( CASE WHEN ACCIDENTGRADE IN ( '06' ) THEN 1 ELSE NULL END ) LEVEL6,
        count( CASE WHEN ACCIDENTGRADE IN ( '07' ) THEN 1 ELSE NULL END ) LEVEL7,
        count( CASE WHEN ACCIDENTGRADE IN ( '08' ) THEN 1 ELSE NULL END ) LEVEL8
        FROM
        bd_inc_personalaccident

    </select>
    <select id="getPowergridAccidentGrade" resultType="java.util.Map">
        SELECT
        count( CASE WHEN ACCIDENTGRADE IN ( '01', '02', '03', '04' ) THEN 1 ELSE NULL END ) LEVEL4,
        count( CASE WHEN ACCIDENTGRADE IN ( '05' ) THEN 1 ELSE NULL END ) LEVEL5,
        count( CASE WHEN ACCIDENTGRADE IN ( '06' ) THEN 1 ELSE NULL END ) LEVEL6,
        count( CASE WHEN ACCIDENTGRADE IN ( '07' ) THEN 1 ELSE NULL END ) LEVEL7,
        count( CASE WHEN ACCIDENTGRADE IN ( '08' ) THEN 1 ELSE NULL END ) LEVEL8
        FROM
        bd_inc_powergridaccident

    </select>
    <select id="getAccidentGridcrop" resultType="java.util.Map">
        SELECT
        b.EQUIPACCIDENT_cnt,
        c.POWERGRIDACCIDENT_cnt,
        d.PERSONALACCIDENT_cnt,
        e.INFORMACCIDENT_cnt,
        a.column_type_name DATAREPORT_ORG,
        a.column_type_code DATAREPORT_ORG_ID
        FROM
        ( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'DATAREPORT_ORG' ) a
        left join (select GRIDCORP ,count(OBJID) EQUIPACCIDENT_cnt  from bd_inc_equipaccident  group by GRIDCORP) b on a.column_type_code = b.GRIDCORP
        left join (select GRIDCROP ,count(PKID) POWERGRIDACCIDENT_cnt  from bd_inc_powergridaccident  group by GRIDCROP) c on a.column_type_code = c.GRIDCROP
        left join (select GRIDCROP ,count(OBJID) PERSONALACCIDENT_cnt  from bd_inc_personalaccident  group by GRIDCROP) d on a.column_type_code = d.GRIDCROP
        left join (select GRIDCROP ,count(OBJID) INFORMACCIDENT_cnt  from bd_inc_informaccident  group by GRIDCROP) e on a.column_type_code = e.GRIDCROP
        GROUP BY
        a.column_type_name,
        a.column_type_code
        ORDER BY
        a.column_type_code +0
    </select>
    <select id="getAccidentVoltageLevel" resultType="java.util.Map">
        select
        b.EQUIPACCIDENT_cnt,
        c.POWERGRIDACCIDENT_cnt,
        a.column_type_name DATAREPORT_ORG,
        a.column_type_code DATAREPORT_ORG_ID
        from
        ( SELECT * FROM srp_risk_sys_tab WHERE column_code = 'VOLTAGE_LEVEL' ) a
        left join (select VOLTAGE_CAPACITY ,count(OBJID) EQUIPACCIDENT_cnt from bd_inc_equipaccident  group by VOLTAGE_CAPACITY)b on a.column_type_code = b.VOLTAGE_CAPACITY
        left join (select VOLTAGE_CAPACITY, count(PKID) POWERGRIDACCIDENT_cnt from bd_inc_powergridaccident  group by VOLTAGE_CAPACITY)c on a.column_type_code = c.VOLTAGE_CAPACITY
        group by
        a.column_type_name,
        a.column_type_code
        order by
        a.column_type_code +0
    </select>
    <select id="getEquipAccidentDesc" resultType="java.util.Map">
        select
        b.EQUIPACCIDENT_cnt,
        a.column_type_name DATAREPORT_ORG,
        a.column_type_code DATAREPORT_ORG_ID
        from
        (select * from srp_risk_sys_tab where column_code = 'REASON') a
        left join (select REASON,count(OBJID) EQUIPACCIDENT_cnt from bd_inc_equipaccident  group by REASON)b on a.column_type_code = b.REASON
        group by
        a.column_type_name,
        a.column_type_code
        order by EQUIPACCIDENT_cnt DESC limit 10
    </select>
    <select id="getPowergridAccidentDesc" resultType="java.util.Map">
        select
        b.POWERGRIDACCIDENT_cnt,
        a.column_type_name DATAREPORT_ORG,
        a.column_type_code DATAREPORT_ORG_ID
        from
        (select * from srp_risk_sys_tab where column_code = 'REASON') a
        left join (select REASON,count(PKID) POWERGRIDACCIDENT_cnt from bd_inc_powergridaccident  group by REASON)b on a.column_type_code = b.REASON
        group by
        a.column_type_name,
        a.column_type_code
        order by POWERGRIDACCIDENT_cnt DESC limit 10
    </select>
    <select id="getPersonalAccidentDesc" resultType="java.util.Map">
        select
        b.PERSONALACCIDENT_cnt,
        a.column_type_name DATAREPORT_ORG,
        a.column_type_code DATAREPORT_ORG_ID
        from
        (select * from srp_risk_sys_tab where column_code = 'DIRECTREASON') a
        left join (select DIRECTREASON,count(OBJID) PERSONALACCIDENT_cnt from bd_inc_personalaccident  group by DIRECTREASON)b on a.column_type_code = b.DIRECTREASON
        group by
        a.column_type_name,
        a.column_type_code
        order by PERSONALACCIDENT_cnt DESC limit 10
    </select>
    <select id="getInformAccidentDesc" resultType="java.util.Map">
        select
        b.INFORMACCIDENT_cnt,
        a.column_type_name DATAREPORT_ORG,
        a.column_type_code DATAREPORT_ORG_ID
        from
        (select * from srp_risk_sys_tab where column_code = 'REASON') a
        left join (select IREASON,count(OBJID) INFORMACCIDENT_cnt from bd_inc_informaccident  group by IREASON)b on a.column_type_code = b.IREASON
        group by
        a.column_type_name,
        a.column_type_code
        order by INFORMACCIDENT_cnt DESC limit 10
    </select>
    <select id="getSrpRiskSysTab" resultType="java.util.Map">
        select em_id,
        column_code,
        column_name,
        column_type_name,
        column_type_code,
        column_num
        from srp_risk_sys_tab
    </select>


</mapper>