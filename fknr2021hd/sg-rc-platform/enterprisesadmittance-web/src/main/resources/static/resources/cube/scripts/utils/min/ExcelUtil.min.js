define([],function(){var me={};me.baseUrl=null;me.params=null;me.ids=null;me.type="get";me.setBaseUrl=function(p_baseUrl){if(me.baseUrl!=p_baseUrl)me.baseUrl=p_baseUrl};me.setParams=function(p_params){if(me.params!=p_params)me.params=p_params};me.setType=function(p_type){if(me.type!=p_type)me.type=p_type};me.setIds=function(p_ids){if(me.ids!=p_ids)me.ids=p_ids};me.exportExcel=function(){if(me.baseUrl!=null)if(me.ids==null&&me.type=="get"){if($.isPlainObject(me.params)){if(typeof me.params.fileName!=
"undefined")me.params.fileName=encodeURIComponent(encodeURIComponent(me.params.fileName));if(typeof me.params.columnCaptions!="undefined")me.params.columnCaptions=encodeURIComponent(encodeURIComponent(me.params.columnCaptions));if(typeof me.params.filter!="undefined")me.params.filter=encodeURIComponent(encodeURIComponent(me.params.filter))}var params="";if($.isPlainObject(me.params))for(var key in me.params)if(params=="")params+=key+"="+me.params[key];else params+="&"+key+"="+me.params[key];window.open(cube.mappath(me.baseUrl)+
(cube.isEmpty(params)?"":"?"+params),"_parent")}else{var __exportExcelFormFrame=$("#__exportExcelFormFrame");if(__exportExcelFormFrame.length>0)__exportExcelFormFrame.remove();var iframe=$("<iframe id='__exportExcelFormFrame' name='__exportExcelFormFrame' style='display:none;position:absolute;main:-1000px;width:1px;height:1px'></iframe>");$("body").append(iframe);iframe.on("load",function(){var content="";try{content=iframe.contents().find("body").html()}catch(e){content="error"}if(cube.notEmpty(content))cube.indicate("warning",
cube.msg("EXPORT_FAIL"))});var form=$("#__exportExcelForm");if(form.length==0){form=$("<form>");form.attr("id","__exportExcelForm");form.attr("style","display:none");form.attr("target","__exportExcelFormFrame");form.attr("method","post");$("body").append(form)}else form.empty();form.attr("action",me.baseUrl);if(me.ids!=null){var input=$("<input>");input.attr("type","hidden");input.attr("name","ids");input.attr("value",me.ids.join(","));form.append(input)}if($.isPlainObject(me.params))for(var key in me.params){var input=
$("<input>");input.attr("type","hidden");input.attr("name",key);input.attr("value",me.params[key]);form.append(input)}form.submit()}};return me});