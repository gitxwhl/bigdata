define([],function(){function h(e){var a=this;a.items=[];a.t_items=[];a.isShowNull=!0;a.isSelectedFirst=!1;a.isShowCheckbox=!1;a.isAllowEdit=!1;a.hasFocus=!1;a.autoMatching=!0;a.readOnly=!1;a.selectedValue=null;a.isClickShow=!1;a._checkListvalue=[];a.dropdownFocus=!1;a._checkText="";a.selectedItem=cube.comp(function(){return a.getSelectedItem()},a);a.isSplit=!1;a.width="auto";a.dropdownMenuHeight="auto";a.isShowScroll=!1;a.isShowDropdownOptions=!1;a.disabled=!1;a.isHrefRoute=!1;a.isExtDisplay=!1;
a.isTextEllipsis=!1;a.addItem=!1;a.textAlign="left";a._ulHeight=null;a._isInputValueChange=!0;a.onSelectedChanged=null;a.onFocus=null;a.onRendered=null;a.commonRendered=null;a._init=function(){a.isAllowEdit()?a.t_items(cube.clone(a.items())):a.t_items=a.items;a.dropdownMenuHeight!="auto"&&a.isShowScroll(!0);a.itemschanged();a.itemsSub=cube.subscribe(a.items,a.itemschanged);a.checkListvalueSub=cube.subscribe(a._checkListvalue,a._checkListValuechanged);a.isShowCheckbox()==!0&&cube.notEmpty(a.selectedValue())&&
a._checkListvalue(a.selectedValue().split(","));if(a.isAllowEdit()&&a.autoMatching())a.checkTextSub=cube.subscribe(a._checkText,function(b){a._isInputValueChange()&&(cube.notEmpty(b)?(a.t_items.removeAll(),$.each(a.items(),function(){this.text.indexOf(b)!=-1&&a.t_items.push(this)})):(a.t_items(cube.clone(a.items())),a._checkListvalue([])),a.t_items().length>0?a.doOpenDropdownOptions():a.doCloseDropdownOptions(),a.selectedValue(b))});a.selectedValueSub=cube.subscribe(a.selectedValue,function(b){if(!a._isInputValueChange()){cube.isEmpty(b)&&
a._checkListvalue([]);if(a.onSelectedChanged!=null&&!cube.isObservable(a.onSelectedChanged))a.onSelectedChanged(a.getSelectedItem());if(a.isHrefRoute())window.location.hash=b}});a.hasFocusSub=cube.subscribe(a.hasFocus,function(b){if(b&&a.onFocus!=null&&!cube.isObservable(a.onFocus))a.onFocus(a.selectedValue(),a)})};a.doOpenDropdownOptions=function(b,d){var c=$(b).siblings(".dropdown-menu");b.className=="btn dropdown-toggle"&&d.target.className!="caret"&&c.animate({scrollTop:0},100);if(!a.isClickShow()||
!(typeof d!="undefined"&&d.type=="mouseover"&&b.tagName=="BUTTON"))a.isExtDisplay()&&b!=void 0&&b.className=="btn dropdown-toggle"&&d.target.className!="caret"&&a.showlog(b,c,d),a.disabled()==!1&&a.readOnly()==!1&&!a.isShowDropdownOptions()&&(a.isShowDropdownOptions(!0),a.dropdownFocus(!0))};a.showlog=function(b,d,c){d.css("position","fixed");d.css("z-index","5000");var f=c.target?c.target:c.srcElement,e=c.layerY?c.layerY:c.offsetY,g=c.layerX?c.layerX:c.offsetX;if((f.className.indexOf("btn dropdown-toggle")!=
-1||f.parentElement.className.indexOf("btn dropdown-toggle")!=-1)&&c.clientX!=g)$(window).height()-c.clientY-b.offsetHeight>d.innerHeight()?(d.css("left",c.clientX-g-f.offsetLeft),d.css("top",c.clientY-e+b.offsetHeight-f.offsetTop)):(b=c.clientY-e-d.innerHeight(),a._ulHeight(b),d.css("left",c.clientX-g-f.offsetLeft),d.css("top",b-f.offsetTop))};a.appendItems=function(){a.items.push({value:e.data.addItem.value(),text:e.data.addItem.value()})};a.doCloseDropdownOptions=function(b,d){if(a.isClickShow()&&
d!=void 0){var c=d.toElement||d.relatedTarget;if(c&&c.tagName=="SPAN"){if(c=$(c).parent().parent(),c.hasClass("dropdowneditor"))return}else if(c&&c.tagName=="BUTTON"){if($(c).hasClass("dropdown-toggle"))return}else if(c&&c.tagName=="INPUT"&&(c=$(c).parent().parent(),c.hasClass("dropdowneditor")))return}a.disabled()==!1&&a.isShowDropdownOptions()&&a.isShowDropdownOptions(!1)};a.selectItem=function(){if(a.isShowCheckbox()){for(var b=a._checkListvalue(),d=!1,c=0;c<b.length;c++)if(b[c]==this.value){d=
!0;break}d?a._checkListvalue.remove(this.value):a._checkListvalue.push(this.value)}else a._isInputValueChange(!1),a.selectedValue(this.value),a.isShowDropdownOptions(!1),a._isInputValueChange(!0);a.isAllowEdit()&&a.getSelectedItem()};a.appendItem=function(b){a.items.push(b)};a._checkListValuechanged=function(){a.selectedValue(a._checkListvalue().join(","));a.isAllowEdit()&&a.getSelectedItem()};a.itemschanged=function(b){if(cube.isEmpty(a.selectedValue())||typeof b!="undefined")(a.isShowNull()||a.isShowCheckbox())&&
!a.isSelectedFirst()?a.selectedValue(""):!a.isShowNull()&&cube.notEmpty(a.items())&&a.items().length>0&&a.isSelectedFirst()&&a.selectedValue(a.items()[0].value)};a.getSelectedItem=function(){var b=null;if(a.isShowCheckbox()){if(a.items()&&a.items().length>0){var b=[],d=[],c=a._checkListvalue();$.each(a.items(),function(){for(var a=0;a<c.length;a++)c[a]==this.value&&(b.push(this),d.push(this.text))});a._isInputValueChange(!1);a._checkText(d.join(","));d.length==0&&(b=null);a._isInputValueChange(!0)}}else a.items()&&
a.items().length>0&&(cube.isEmpty(a.selectedValue())?(a._isInputValueChange(!1),a._checkText(""),a._isInputValueChange(!0)):$.each(a.items(),function(){a.selectedValue()==this.value&&(b=this,a._isInputValueChange(!1),a._checkText(this.text),a._isInputValueChange(!0))}));return b};a.doClickDropdownOptions=function(b,d){var c=$(b).parent().siblings(".dropdown-menu");b.className=="btn dropdown-toggle split-toggle"&&c.animate({scrollTop:0},100);a.isExtDisplay()&&b.className=="btn dropdown-toggle split-toggle"&&
a.showlog(b,c,d);!a.disabled()&&!a.readOnly()&&(a.isShowDropdownOptions()?a.isShowDropdownOptions(!1):a.isShowDropdownOptions(!0),a.dropdownFocus(!0))};a.mouseoverPopoverDialog=function(){a.dropdownFocus(!0)};a.mousedownInnerPopoverDialog=function(){a.dropdownFocus(!0)};a.onload=function(b,d){a.commonRendered!=null&&!cube.isObservable(a.commonRendered)&&a.commonRendered(b,d);if(a.onRendered!=null&&!cube.isObservable(a.onRendered))a.onRendered(b,d)};cube.endViewModel(a,e)}h.prototype.dispose=function(){this.selectedItem.dispose();
this.itemsSub.dispose();this.checkListvalueSub.dispose();this.selectedValueSub.dispose();this.hasFocusSub.dispose()};return h});